# 数据保存

执行下面的代码，将三通道矩阵信息保存为图像。

```cpp
#include <opencv2/opencv.hpp>
#include <iostream>

using namespace cv;
using namespace std;

int main(int argc, char const *argv[])
{
    Mat img(512, 512, CV_8UC3, Scalar(255, 0, 255));
    imshow("IMG", img);
    if (!imwrite("demo.png", img))
    {
        cout << "Could not write image.\n" << endl;
        return -1;
    }
    waitKey(0);
    destroyAllWindows();
    return 0;
}
```

执行下面的代码，调用本机摄像头录制视频并保存到本地。

```cpp
#include <opencv2/opencv.hpp>
#include <iostream>

using namespace cv;
using namespace std;

int main(int argc, char const *argv[])
{
    VideoCapture video(0);
    Mat img;
    VideoWriter writer;
    int k;
    if (!video.isOpened())
    {
        cout << "Count not load video.\n" << endl;
        return -1;
    }
    video >> img;
    if (img.empty())
    {
        cout << "Count not load image.\n" << endl;
        return -1;
    }
    writer.open("video.avi", VideoWriter::fourcc('M', 'J', 'P', 'G'), 30.0, img.size());
    if (!writer.isOpened())
    {
        cout << "Count not load file.\n" << endl;
        return -1;
    }
    while (true)
    {
        if (!video.read(img))
        {
            break;
        }
        imshow("VIDEO", img);
        writer.write(img);
        k = waitKey(1);
        if (k == 27)
        {
            return 0;
        }
    }
    waitKey(0);
    video.release();
    writer.release();
    destroyAllWindows();
    return 0;
}
```

执行下面的代码，打开 `demo.xml` 文件并写入数据。

```cpp
#include <opencv2/opencv.hpp>
#include <iostream>

using namespace cv;
using namespace std;

int main(int argc, char const *argv[])
{
    FileStorage file("demo.xml", FileStorage::WRITE);
    Mat img = Mat::eye(5, 5, CV_8UC1);
    float num = 6.9;
    string str = "OpenCV";
    if (!file.isOpened())
    {
        cout << "Could not load file.\n" << endl;
        return -1;
    }
    cout << img << endl;
    file.write("IMG", img);
    cout << num << endl;
    file.write("NUM", num);
    cout << str << endl;
    file.write("STR", str);
    file.release();
    return 0;
}
```

执行下面的代码，打开 `demo.xml` 文件并读取数据。

```cpp
#include <opencv2/opencv.hpp>
#include <iostream>

using namespace cv;
using namespace std;

int main(int argc, char const *argv[])
{
    FileStorage file("demo.xml", FileStorage::READ);
    Mat img;
    float num;
    string str;
    if (!file.isOpened())
    {
        cout << "Could not load file.\n" << endl;
        return -1;
    }
    file["IMG"] >> img;
    cout << img << endl;
    file["NUM"] >> num;
    cout << num << endl;
    file["STR"] >> str;
    cout << str << endl;
    file.release();
    return 0;
}
```

